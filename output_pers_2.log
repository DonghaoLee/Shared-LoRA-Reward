nohup: ignoring input
8866
[2024-09-26 05:08:16,355] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-26 05:08:27,086] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-26 05:08:29,639] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-09-26 05:08:29,639] [INFO] [comm.py:683:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Some weights of GPTJForSequenceClassification were not initialized from the model checkpoint at EleutherAI/gpt-j-6b and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/home/donghao_dev/project/Shared-LoRA-Reward/src/personalized_finetune.py:281: UserWarning: pad_token_id is None, setting pad_token_id to eos_token_id
  warnings.warn("pad_token_id is None, setting pad_token_id to eos_token_id")
/home/donghao_dev/project/Shared-LoRA-Reward/src/personalized_finetune.py:291: UserWarning: No chat template found. Directly concatenate the prompt and the response.
  warnings.warn("No chat template found. Directly concatenate the prompt and the response.")
We will filter the dataset to only include the top-5 users with the most samples on the training set.
[Train] Number of unique workers: 53
[Train] Top-5 workers: [('KZL1qeRzHNYSfDAuOctL1iyVV8WC5N', 12985), ('ZzGCcAhvqF0HnKxNsUjtJFadcZdyZj', 6296), ('p4Oh7rUGyLe1EpilJFWr9sPDpkO016', 5633), ('qo6WIyEh27cwAjWpA3Q60J7NaDxzQJ', 5547), ('zKV8BFGy60O0q7102ALF84S6Jo5i4q', 5373)]
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
Filtered training samples: 35834
Filtered validation samples: 15421
Downsampling training set, preserve 5373 samples for each worker.
Downsampling validation set, preserve 1238 samples for each worker.
Worker KZL1qeRzHNYSfDAuOctL1iyVV8WC5N
Worker ZzGCcAhvqF0HnKxNsUjtJFadcZdyZj
Worker p4Oh7rUGyLe1EpilJFWr9sPDpkO016
Worker qo6WIyEh27cwAjWpA3Q60J7NaDxzQJ
Worker zKV8BFGy60O0q7102ALF84S6Jo5i4q
Downsampled training samples: 26865
Downsampled validation samples: 6190
Map:   0%|          | 0/26865 [00:00<?, ? examples/s]Map:   2%|▏         | 481/26865 [00:00<00:05, 4717.49 examples/s]Map:   4%|▎         | 973/26865 [00:00<00:05, 4830.93 examples/s]Map:   6%|▌         | 1489/26865 [00:00<00:06, 3858.53 examples/s]Map:   7%|▋         | 1985/26865 [00:00<00:05, 4225.15 examples/s]Map:   9%|▉         | 2490/26865 [00:00<00:06, 3859.72 examples/s]Map:  11%|█         | 2976/26865 [00:00<00:05, 4140.61 examples/s]Map:  13%|█▎        | 3492/26865 [00:01<00:09, 2590.57 examples/s]Map:  15%|█▍        | 3978/26865 [00:01<00:07, 3030.01 examples/s]Map:  17%|█▋        | 4490/26865 [00:01<00:07, 2992.98 examples/s]Map:  19%|█▊        | 4980/26865 [00:01<00:06, 3392.95 examples/s]Map:  20%|██        | 5489/26865 [00:01<00:06, 3336.87 examples/s]Map:  22%|██▏       | 5973/26865 [00:01<00:05, 3674.04 examples/s]Map:  24%|██▍       | 6482/26865 [00:01<00:05, 3557.35 examples/s]Map:  26%|██▌       | 6971/26865 [00:01<00:05, 3868.86 examples/s]Map:  28%|██▊       | 7480/26865 [00:02<00:05, 3697.70 examples/s]Map:  30%|██▉       | 7967/26865 [00:02<00:04, 3977.57 examples/s]Map:  32%|███▏      | 8483/26865 [00:02<00:04, 3726.47 examples/s]Map:  33%|███▎      | 8975/26865 [00:02<00:04, 4013.24 examples/s]Map:  35%|███▌      | 9486/26865 [00:02<00:04, 3771.67 examples/s]Map:  37%|███▋      | 9971/26865 [00:02<00:04, 4032.52 examples/s]Map:  39%|███▉      | 10482/26865 [00:02<00:04, 3781.96 examples/s]Map:  41%|████      | 10966/26865 [00:02<00:03, 4039.12 examples/s]Map:  43%|████▎     | 11490/26865 [00:03<00:04, 3746.39 examples/s]Map:  45%|████▍     | 11977/26865 [00:03<00:03, 4015.35 examples/s]Map:  46%|████▋     | 12486/26865 [00:03<00:03, 3746.23 examples/s]Map:  48%|████▊     | 12971/26865 [00:03<00:03, 4012.14 examples/s]Map:  50%|█████     | 13483/26865 [00:03<00:03, 3756.01 examples/s]Map:  52%|█████▏    | 13973/26865 [00:03<00:03, 4031.04 examples/s]Map:  54%|█████▍    | 14489/26865 [00:03<00:03, 3113.26 examples/s]Map:  56%|█████▌    | 14980/26865 [00:04<00:03, 3487.55 examples/s]Map:  58%|█████▊    | 15487/26865 [00:04<00:03, 3413.26 examples/s]Map:  59%|█████▉    | 15971/26865 [00:04<00:02, 3733.80 examples/s]Map:  61%|██████▏   | 16481/26865 [00:04<00:02, 3597.84 examples/s]Map:  63%|██████▎   | 16962/26865 [00:04<00:02, 3881.44 examples/s]Map:  65%|██████▌   | 17480/26865 [00:04<00:02, 3666.96 examples/s]Map:  67%|██████▋   | 17962/26865 [00:04<00:02, 3940.54 examples/s]Map:  69%|██████▉   | 18479/26865 [00:05<00:02, 3717.29 examples/s]Map:  71%|███████   | 18968/26865 [00:05<00:01, 3996.95 examples/s]Map:  73%|███████▎  | 19479/26865 [00:05<00:01, 3709.31 examples/s]Map:  74%|███████▍  | 19962/26865 [00:05<00:01, 3976.90 examples/s]Map:  76%|███████▌  | 20478/26865 [00:05<00:01, 3755.17 examples/s]Map:  78%|███████▊  | 20963/26865 [00:05<00:01, 4018.38 examples/s]Map:  80%|███████▉  | 21484/26865 [00:05<00:01, 3750.57 examples/s]Map:  82%|████████▏ | 21963/26865 [00:05<00:01, 4000.25 examples/s]Map:  84%|████████▎ | 22479/26865 [00:06<00:01, 3767.21 examples/s]Map:  85%|████████▌ | 22961/26865 [00:06<00:00, 4021.34 examples/s]Map:  87%|████████▋ | 23480/26865 [00:06<00:00, 3768.04 examples/s]Map:  89%|████████▉ | 23963/26865 [00:06<00:00, 4023.82 examples/s]Map:  91%|█████████ | 24478/26865 [00:06<00:00, 3756.60 examples/s]Map:  93%|█████████▎| 24966/26865 [00:06<00:00, 4026.75 examples/s]Map:  95%|█████████▍| 25483/26865 [00:06<00:00, 3744.52 examples/s]Map:  97%|█████████▋| 25968/26865 [00:06<00:00, 4010.41 examples/s]Map:  99%|█████████▊| 26480/26865 [00:07<00:00, 3756.98 examples/s]Map: 100%|██████████| 26865/26865 [00:07<00:00, 3726.15 examples/s]
Map:   0%|          | 0/6190 [00:00<?, ? examples/s]Map:   1%|          | 68/6190 [00:00<00:18, 332.68 examples/s]Map:   9%|▉         | 553/6190 [00:00<00:02, 2188.95 examples/s]Map:  16%|█▌        | 1000/6190 [00:00<00:01, 2608.19 examples/s]Map:  24%|██▍       | 1483/6190 [00:00<00:01, 3299.73 examples/s]Map:  32%|███▏      | 1965/6190 [00:00<00:01, 3765.52 examples/s]Map:  40%|████      | 2483/6190 [00:00<00:01, 3585.61 examples/s]Map:  48%|████▊     | 2964/6190 [00:00<00:00, 3915.00 examples/s]Map:  56%|█████▋    | 3482/6190 [00:01<00:00, 3700.97 examples/s]Map:  64%|██████▍   | 3968/6190 [00:01<00:00, 3998.46 examples/s]Map:  72%|███████▏  | 4485/6190 [00:01<00:00, 3533.04 examples/s]Map:  80%|████████  | 4962/6190 [00:01<00:00, 3828.07 examples/s]Map:  88%|████████▊ | 5478/6190 [00:01<00:00, 3628.08 examples/s]Map:  96%|█████████▋| 5965/6190 [00:01<00:00, 3924.60 examples/s]Map: 100%|██████████| 6190/6190 [00:01<00:00, 3406.61 examples/s]
Map:   0%|          | 0/26865 [00:00<?, ? examples/s]Map:   4%|▎         | 1000/26865 [00:04<02:00, 213.89 examples/s]Map:   7%|▋         | 2000/26865 [00:09<01:58, 210.56 examples/s]Map:  11%|█         | 3000/26865 [00:14<01:53, 210.16 examples/s]Map:  15%|█▍        | 4000/26865 [00:19<01:48, 209.95 examples/s]Map:  19%|█▊        | 5000/26865 [00:23<01:44, 208.27 examples/s]Map:  22%|██▏       | 6000/26865 [00:28<01:40, 207.90 examples/s]Map:  26%|██▌       | 7000/26865 [00:33<01:35, 209.01 examples/s]Map:  30%|██▉       | 8000/26865 [00:38<01:30, 208.49 examples/s]Map:  34%|███▎      | 9000/26865 [00:43<01:26, 205.87 examples/s]Map:  37%|███▋      | 10000/26865 [00:48<01:21, 206.69 examples/s]Map:  41%|████      | 11000/26865 [00:52<01:16, 207.07 examples/s]Map:  45%|████▍     | 12000/26865 [00:57<01:11, 208.44 examples/s]Map:  48%|████▊     | 13000/26865 [01:02<01:06, 209.14 examples/s]Map:  52%|█████▏    | 14000/26865 [01:07<01:04, 199.26 examples/s]Map:  56%|█████▌    | 15000/26865 [01:13<01:00, 197.62 examples/s]Map:  60%|█████▉    | 16000/26865 [01:17<00:54, 200.50 examples/s]Map:  63%|██████▎   | 17000/26865 [01:22<00:49, 201.32 examples/s]Map:  67%|██████▋   | 18000/26865 [01:27<00:44, 199.06 examples/s]Map:  71%|███████   | 19000/26865 [01:32<00:39, 200.61 examples/s]Map:  74%|███████▍  | 20000/26865 [01:37<00:33, 202.29 examples/s]Map:  78%|███████▊  | 21000/26865 [01:42<00:28, 203.01 examples/s]Map:  82%|████████▏ | 22000/26865 [01:47<00:23, 204.50 examples/s]Map:  86%|████████▌ | 23000/26865 [01:52<00:18, 203.92 examples/s]Map:  89%|████████▉ | 24000/26865 [01:57<00:14, 203.96 examples/s]Map:  93%|█████████▎| 25000/26865 [02:02<00:09, 205.34 examples/s]Map:  97%|█████████▋| 26000/26865 [02:06<00:04, 205.31 examples/s]Map: 100%|██████████| 26865/26865 [02:11<00:00, 204.49 examples/s]Map: 100%|██████████| 26865/26865 [02:11<00:00, 204.79 examples/s]
Map:   0%|          | 0/6190 [00:00<?, ? examples/s]Map:  16%|█▌        | 1000/6190 [00:04<00:25, 201.88 examples/s]Map:  32%|███▏      | 2000/6190 [00:09<00:20, 203.09 examples/s]Map:  48%|████▊     | 3000/6190 [00:14<00:15, 206.56 examples/s]Map:  65%|██████▍   | 4000/6190 [00:19<00:10, 208.25 examples/s]Map:  81%|████████  | 5000/6190 [00:24<00:05, 205.14 examples/s]Map:  97%|█████████▋| 6000/6190 [00:29<00:00, 206.73 examples/s]Map: 100%|██████████| 6190/6190 [00:30<00:00, 206.58 examples/s]Map: 100%|██████████| 6190/6190 [00:30<00:00, 206.02 examples/s]
Selecting labeler: 1
Filter:   0%|          | 0/26865 [00:00<?, ? examples/s]Filter:   4%|▎         | 1000/26865 [00:01<00:32, 794.93 examples/s]Filter:   7%|▋         | 2000/26865 [00:02<00:31, 792.16 examples/s]Filter:  11%|█         | 3000/26865 [00:03<00:30, 790.70 examples/s]Filter:  15%|█▍        | 4000/26865 [00:05<00:28, 799.10 examples/s]Filter:  19%|█▊        | 5000/26865 [00:07<00:34, 628.40 examples/s]Filter:  22%|██▏       | 6000/26865 [00:10<00:42, 487.74 examples/s]Filter:  26%|██▌       | 7000/26865 [00:11<00:35, 561.97 examples/s]Filter:  30%|██▉       | 8000/26865 [00:12<00:30, 621.51 examples/s]Filter:  34%|███▎      | 9000/26865 [00:13<00:26, 667.23 examples/s]Filter:  37%|███▋      | 10000/26865 [00:15<00:23, 706.17 examples/s]Filter:  41%|████      | 11000/26865 [00:16<00:21, 734.42 examples/s]Filter:  45%|████▍     | 12000/26865 [00:17<00:19, 759.14 examples/s]Filter:  48%|████▊     | 13000/26865 [00:18<00:17, 775.62 examples/s]Filter:  52%|█████▏    | 14000/26865 [00:20<00:16, 787.07 examples/s]Filter:  56%|█████▌    | 15000/26865 [00:21<00:14, 798.59 examples/s]Filter:  60%|█████▉    | 16000/26865 [00:22<00:13, 801.76 examples/s]Filter:  63%|██████▎   | 17000/26865 [00:23<00:12, 791.37 examples/s]Filter:  67%|██████▋   | 18000/26865 [00:25<00:11, 793.63 examples/s]Filter:  71%|███████   | 19000/26865 [00:26<00:09, 795.14 examples/s]Filter:  74%|███████▍  | 20000/26865 [00:27<00:08, 797.47 examples/s]Filter:  78%|███████▊  | 21000/26865 [00:28<00:07, 798.33 examples/s]Filter:  82%|████████▏ | 22000/26865 [00:29<00:06, 803.05 examples/s]Filter:  86%|████████▌ | 23000/26865 [00:31<00:04, 800.48 examples/s]Filter:  89%|████████▉ | 24000/26865 [00:32<00:03, 797.27 examples/s]Filter:  93%|█████████▎| 25000/26865 [00:33<00:02, 803.37 examples/s]Filter:  97%|█████████▋| 26000/26865 [00:34<00:01, 803.65 examples/s]Filter: 100%|██████████| 26865/26865 [00:36<00:00, 800.83 examples/s]Filter: 100%|██████████| 26865/26865 [00:36<00:00, 744.73 examples/s]
Filter:   0%|          | 0/6190 [00:00<?, ? examples/s]Filter:  16%|█▌        | 1000/6190 [00:01<00:06, 772.15 examples/s]Filter:  32%|███▏      | 2000/6190 [00:02<00:05, 789.81 examples/s]Filter:  48%|████▊     | 3000/6190 [00:03<00:04, 744.62 examples/s]Filter:  65%|██████▍   | 4000/6190 [00:05<00:02, 777.94 examples/s]Filter:  81%|████████  | 5000/6190 [00:06<00:01, 788.37 examples/s]Filter:  97%|█████████▋| 6000/6190 [00:07<00:00, 803.78 examples/s]Filter: 100%|██████████| 6190/6190 [00:07<00:00, 806.77 examples/s]Filter: 100%|██████████| 6190/6190 [00:07<00:00, 789.95 examples/s]
LoRA Target Modules:  ['q_proj', 'v_proj']
LoRA model
GPTJForSequenceClassification(
  (transformer): GPTJModel(
    (wte): Embedding(50400, 4096)
    (drop): Dropout(p=0.0, inplace=False)
    (h): ModuleList(
      (0-27): 28 x GPTJBlock(
        (ln_1): LayerNorm((4096,), eps=1e-05, elementwise_affine=True)
        (attn): GPTJAttention(
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
          (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (v_proj): LinearLayer_PSLoRA(
            (lora_A): Linear(in_features=4096, out_features=32, bias=False)
            (lora_B): Linear(in_features=32, out_features=4096, bias=False)
            (lora_dropout): Dropout(p=0.05, inplace=False)
          )
          (q_proj): LinearLayer_PSLoRA(
            (lora_A): Linear(in_features=4096, out_features=32, bias=False)
            (lora_B): Linear(in_features=32, out_features=4096, bias=False)
            (lora_dropout): Dropout(p=0.05, inplace=False)
          )
          (out_proj): Linear(in_features=4096, out_features=4096, bias=False)
        )
        (mlp): GPTJMLP(
          (fc_in): Linear(in_features=4096, out_features=16384, bias=True)
          (fc_out): Linear(in_features=16384, out_features=4096, bias=True)
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
    )
    (ln_f): LayerNorm((4096,), eps=1e-05, elementwise_affine=True)
  )
  (score): Linear(in_features=4096, out_features=1, bias=False)
)
dict_keys(['transformer.h.0.attn.k_proj.weight', 'transformer.h.0.attn.out_proj.weight', 'transformer.h.0.attn.q_proj.lora_A.weight', 'transformer.h.0.attn.q_proj.lora_B.weight', 'transformer.h.0.attn.q_proj.weight', 'transformer.h.0.attn.v_proj.lora_A.weight', 'transformer.h.0.attn.v_proj.lora_B.weight', 'transformer.h.0.attn.v_proj.weight', 'transformer.h.0.ln_1.bias', 'transformer.h.0.ln_1.weight', 'transformer.h.0.mlp.fc_in.bias', 'transformer.h.0.mlp.fc_in.weight', 'transformer.h.0.mlp.fc_out.bias', 'transformer.h.0.mlp.fc_out.weight', 'transformer.h.1.attn.k_proj.weight', 'transformer.h.1.attn.out_proj.weight', 'transformer.h.1.attn.q_proj.lora_A.weight', 'transformer.h.1.attn.q_proj.lora_B.weight', 'transformer.h.1.attn.q_proj.weight', 'transformer.h.1.attn.v_proj.lora_A.weight', 'transformer.h.1.attn.v_proj.lora_B.weight', 'transformer.h.1.attn.v_proj.weight', 'transformer.h.1.ln_1.bias', 'transformer.h.1.ln_1.weight', 'transformer.h.1.mlp.fc_in.bias', 'transformer.h.1.mlp.fc_in.weight', 'transformer.h.1.mlp.fc_out.bias', 'transformer.h.1.mlp.fc_out.weight', 'transformer.h.10.attn.k_proj.weight', 'transformer.h.10.attn.out_proj.weight', 'transformer.h.10.attn.q_proj.lora_A.weight', 'transformer.h.10.attn.q_proj.lora_B.weight', 'transformer.h.10.attn.q_proj.weight', 'transformer.h.10.attn.v_proj.lora_A.weight', 'transformer.h.10.attn.v_proj.lora_B.weight', 'transformer.h.10.attn.v_proj.weight', 'transformer.h.10.ln_1.bias', 'transformer.h.10.ln_1.weight', 'transformer.h.10.mlp.fc_in.bias', 'transformer.h.10.mlp.fc_in.weight', 'transformer.h.10.mlp.fc_out.bias', 'transformer.h.10.mlp.fc_out.weight', 'transformer.h.11.attn.k_proj.weight', 'transformer.h.11.attn.out_proj.weight', 'transformer.h.11.attn.q_proj.lora_A.weight', 'transformer.h.11.attn.q_proj.lora_B.weight', 'transformer.h.11.attn.q_proj.weight', 'transformer.h.11.attn.v_proj.lora_A.weight', 'transformer.h.11.attn.v_proj.lora_B.weight', 'transformer.h.11.attn.v_proj.weight', 'transformer.h.11.ln_1.bias', 'transformer.h.11.ln_1.weight', 'transformer.h.2.attn.k_proj.weight', 'transformer.h.2.attn.out_proj.weight', 'transformer.h.2.attn.q_proj.lora_A.weight', 'transformer.h.2.attn.q_proj.lora_B.weight', 'transformer.h.2.attn.q_proj.weight', 'transformer.h.2.attn.v_proj.lora_A.weight', 'transformer.h.2.attn.v_proj.lora_B.weight', 'transformer.h.2.attn.v_proj.weight', 'transformer.h.2.ln_1.bias', 'transformer.h.2.ln_1.weight', 'transformer.h.2.mlp.fc_in.bias', 'transformer.h.2.mlp.fc_in.weight', 'transformer.h.2.mlp.fc_out.bias', 'transformer.h.2.mlp.fc_out.weight', 'transformer.h.3.attn.k_proj.weight', 'transformer.h.3.attn.out_proj.weight', 'transformer.h.3.attn.q_proj.lora_A.weight', 'transformer.h.3.attn.q_proj.lora_B.weight', 'transformer.h.3.attn.q_proj.weight', 'transformer.h.3.attn.v_proj.lora_A.weight', 'transformer.h.3.attn.v_proj.lora_B.weight', 'transformer.h.3.attn.v_proj.weight', 'transformer.h.3.ln_1.bias', 'transformer.h.3.ln_1.weight', 'transformer.h.3.mlp.fc_in.bias', 'transformer.h.3.mlp.fc_in.weight', 'transformer.h.3.mlp.fc_out.bias', 'transformer.h.3.mlp.fc_out.weight', 'transformer.h.4.attn.k_proj.weight', 'transformer.h.4.attn.out_proj.weight', 'transformer.h.4.attn.q_proj.lora_A.weight', 'transformer.h.4.attn.q_proj.lora_B.weight', 'transformer.h.4.attn.q_proj.weight', 'transformer.h.4.attn.v_proj.lora_A.weight', 'transformer.h.4.attn.v_proj.lora_B.weight', 'transformer.h.4.attn.v_proj.weight', 'transformer.h.4.ln_1.bias', 'transformer.h.4.ln_1.weight', 'transformer.h.4.mlp.fc_in.bias', 'transformer.h.4.mlp.fc_in.weight', 'transformer.h.4.mlp.fc_out.bias', 'transformer.h.4.mlp.fc_out.weight', 'transformer.h.5.attn.k_proj.weight', 'transformer.h.5.attn.out_proj.weight', 'transformer.h.5.attn.q_proj.lora_A.weight', 'transformer.h.5.attn.q_proj.lora_B.weight', 'transformer.h.5.attn.q_proj.weight', 'transformer.h.5.attn.v_proj.lora_A.weight', 'transformer.h.5.attn.v_proj.lora_B.weight', 'transformer.h.5.attn.v_proj.weight', 'transformer.h.5.ln_1.bias', 'transformer.h.5.ln_1.weight', 'transformer.h.5.mlp.fc_in.bias', 'transformer.h.5.mlp.fc_in.weight', 'transformer.h.5.mlp.fc_out.bias', 'transformer.h.5.mlp.fc_out.weight', 'transformer.h.6.attn.k_proj.weight', 'transformer.h.6.attn.out_proj.weight', 'transformer.h.6.attn.q_proj.lora_A.weight', 'transformer.h.6.attn.q_proj.lora_B.weight', 'transformer.h.6.attn.q_proj.weight', 'transformer.h.6.attn.v_proj.lora_A.weight', 'transformer.h.6.attn.v_proj.lora_B.weight', 'transformer.h.6.attn.v_proj.weight', 'transformer.h.6.ln_1.bias', 'transformer.h.6.ln_1.weight', 'transformer.h.6.mlp.fc_in.bias', 'transformer.h.6.mlp.fc_in.weight', 'transformer.h.6.mlp.fc_out.bias', 'transformer.h.6.mlp.fc_out.weight', 'transformer.h.7.attn.k_proj.weight', 'transformer.h.7.attn.out_proj.weight', 'transformer.h.7.attn.q_proj.lora_A.weight', 'transformer.h.7.attn.q_proj.lora_B.weight', 'transformer.h.7.attn.q_proj.weight', 'transformer.h.7.attn.v_proj.lora_A.weight', 'transformer.h.7.attn.v_proj.lora_B.weight', 'transformer.h.7.attn.v_proj.weight', 'transformer.h.7.ln_1.bias', 'transformer.h.7.ln_1.weight', 'transformer.h.7.mlp.fc_in.bias', 'transformer.h.7.mlp.fc_in.weight', 'transformer.h.7.mlp.fc_out.bias', 'transformer.h.7.mlp.fc_out.weight', 'transformer.h.8.attn.k_proj.weight', 'transformer.h.8.attn.out_proj.weight', 'transformer.h.8.attn.q_proj.lora_A.weight', 'transformer.h.8.attn.q_proj.lora_B.weight', 'transformer.h.8.attn.q_proj.weight', 'transformer.h.8.attn.v_proj.lora_A.weight', 'transformer.h.8.attn.v_proj.lora_B.weight', 'transformer.h.8.attn.v_proj.weight', 'transformer.h.8.ln_1.bias', 'transformer.h.8.ln_1.weight', 'transformer.h.8.mlp.fc_in.bias', 'transformer.h.8.mlp.fc_in.weight', 'transformer.h.8.mlp.fc_out.bias', 'transformer.h.8.mlp.fc_out.weight', 'transformer.h.9.attn.k_proj.weight', 'transformer.h.9.attn.out_proj.weight', 'transformer.h.9.attn.q_proj.lora_A.weight', 'transformer.h.9.attn.q_proj.lora_B.weight', 'transformer.h.9.attn.q_proj.weight', 'transformer.h.9.attn.v_proj.lora_A.weight', 'transformer.h.9.attn.v_proj.lora_B.weight', 'transformer.h.9.attn.v_proj.weight', 'transformer.h.9.ln_1.bias', 'transformer.h.9.ln_1.weight', 'transformer.h.9.mlp.fc_in.bias', 'transformer.h.9.mlp.fc_in.weight', 'transformer.h.9.mlp.fc_out.bias', 'transformer.h.9.mlp.fc_out.weight', 'transformer.wte.weight', 'transformer.h.11.mlp.fc_in.bias', 'transformer.h.11.mlp.fc_in.weight', 'transformer.h.11.mlp.fc_out.bias', 'transformer.h.11.mlp.fc_out.weight', 'transformer.h.12.attn.k_proj.weight', 'transformer.h.12.attn.out_proj.weight', 'transformer.h.12.attn.q_proj.lora_A.weight', 'transformer.h.12.attn.q_proj.lora_B.weight', 'transformer.h.12.attn.q_proj.weight', 'transformer.h.12.attn.v_proj.lora_A.weight', 'transformer.h.12.attn.v_proj.lora_B.weight', 'transformer.h.12.attn.v_proj.weight', 'transformer.h.12.ln_1.bias', 'transformer.h.12.ln_1.weight', 'transformer.h.12.mlp.fc_in.bias', 'transformer.h.12.mlp.fc_in.weight', 'transformer.h.12.mlp.fc_out.bias', 'transformer.h.12.mlp.fc_out.weight', 'transformer.h.13.attn.k_proj.weight', 'transformer.h.13.attn.out_proj.weight', 'transformer.h.13.attn.q_proj.lora_A.weight', 'transformer.h.13.attn.q_proj.lora_B.weight', 'transformer.h.13.attn.q_proj.weight', 'transformer.h.13.attn.v_proj.lora_A.weight', 'transformer.h.13.attn.v_proj.lora_B.weight', 'transformer.h.13.attn.v_proj.weight', 'transformer.h.13.ln_1.bias', 'transformer.h.13.ln_1.weight', 'transformer.h.13.mlp.fc_in.bias', 'transformer.h.13.mlp.fc_in.weight', 'transformer.h.13.mlp.fc_out.bias', 'transformer.h.13.mlp.fc_out.weight', 'transformer.h.14.attn.k_proj.weight', 'transformer.h.14.attn.out_proj.weight', 'transformer.h.14.attn.q_proj.lora_A.weight', 'transformer.h.14.attn.q_proj.lora_B.weight', 'transformer.h.14.attn.q_proj.weight', 'transformer.h.14.attn.v_proj.lora_A.weight', 'transformer.h.14.attn.v_proj.lora_B.weight', 'transformer.h.14.attn.v_proj.weight', 'transformer.h.14.ln_1.bias', 'transformer.h.14.ln_1.weight', 'transformer.h.14.mlp.fc_in.bias', 'transformer.h.14.mlp.fc_in.weight', 'transformer.h.14.mlp.fc_out.bias', 'transformer.h.14.mlp.fc_out.weight', 'transformer.h.15.attn.k_proj.weight', 'transformer.h.15.attn.out_proj.weight', 'transformer.h.15.attn.q_proj.lora_A.weight', 'transformer.h.15.attn.q_proj.lora_B.weight', 'transformer.h.15.attn.q_proj.weight', 'transformer.h.15.attn.v_proj.lora_A.weight', 'transformer.h.15.attn.v_proj.lora_B.weight', 'transformer.h.15.attn.v_proj.weight', 'transformer.h.15.ln_1.bias', 'transformer.h.15.ln_1.weight', 'transformer.h.15.mlp.fc_in.bias', 'transformer.h.15.mlp.fc_in.weight', 'transformer.h.15.mlp.fc_out.bias', 'transformer.h.15.mlp.fc_out.weight', 'transformer.h.16.attn.k_proj.weight', 'transformer.h.16.attn.out_proj.weight', 'transformer.h.16.attn.q_proj.lora_A.weight', 'transformer.h.16.attn.q_proj.lora_B.weight', 'transformer.h.16.attn.q_proj.weight', 'transformer.h.16.attn.v_proj.lora_A.weight', 'transformer.h.16.attn.v_proj.lora_B.weight', 'transformer.h.16.attn.v_proj.weight', 'transformer.h.16.ln_1.bias', 'transformer.h.16.ln_1.weight', 'transformer.h.16.mlp.fc_in.bias', 'transformer.h.16.mlp.fc_in.weight', 'transformer.h.16.mlp.fc_out.bias', 'transformer.h.16.mlp.fc_out.weight', 'transformer.h.17.attn.k_proj.weight', 'transformer.h.17.attn.out_proj.weight', 'transformer.h.17.attn.q_proj.lora_A.weight', 'transformer.h.17.attn.q_proj.lora_B.weight', 'transformer.h.17.attn.q_proj.weight', 'transformer.h.17.attn.v_proj.lora_A.weight', 'transformer.h.17.attn.v_proj.lora_B.weight', 'transformer.h.17.attn.v_proj.weight', 'transformer.h.17.ln_1.bias', 'transformer.h.17.ln_1.weight', 'transformer.h.17.mlp.fc_in.bias', 'transformer.h.17.mlp.fc_in.weight', 'transformer.h.17.mlp.fc_out.bias', 'transformer.h.17.mlp.fc_out.weight', 'transformer.h.18.attn.k_proj.weight', 'transformer.h.18.attn.out_proj.weight', 'transformer.h.18.attn.q_proj.lora_A.weight', 'transformer.h.18.attn.q_proj.lora_B.weight', 'transformer.h.18.attn.q_proj.weight', 'transformer.h.18.attn.v_proj.lora_A.weight', 'transformer.h.18.attn.v_proj.lora_B.weight', 'transformer.h.18.attn.v_proj.weight', 'transformer.h.18.ln_1.bias', 'transformer.h.18.ln_1.weight', 'transformer.h.18.mlp.fc_in.bias', 'transformer.h.18.mlp.fc_in.weight', 'transformer.h.18.mlp.fc_out.bias', 'transformer.h.18.mlp.fc_out.weight', 'transformer.h.19.attn.k_proj.weight', 'transformer.h.19.attn.out_proj.weight', 'transformer.h.19.attn.q_proj.lora_A.weight', 'transformer.h.19.attn.q_proj.lora_B.weight', 'transformer.h.19.attn.q_proj.weight', 'transformer.h.19.attn.v_proj.lora_A.weight', 'transformer.h.19.attn.v_proj.lora_B.weight', 'transformer.h.19.attn.v_proj.weight', 'transformer.h.19.ln_1.bias', 'transformer.h.19.ln_1.weight', 'transformer.h.19.mlp.fc_in.bias', 'transformer.h.19.mlp.fc_in.weight', 'transformer.h.19.mlp.fc_out.bias', 'transformer.h.19.mlp.fc_out.weight', 'transformer.h.20.attn.k_proj.weight', 'transformer.h.20.attn.out_proj.weight', 'transformer.h.20.attn.q_proj.lora_A.weight', 'transformer.h.20.attn.q_proj.lora_B.weight', 'transformer.h.20.attn.q_proj.weight', 'transformer.h.20.attn.v_proj.lora_A.weight', 'transformer.h.20.attn.v_proj.lora_B.weight', 'transformer.h.20.attn.v_proj.weight', 'transformer.h.20.ln_1.bias', 'transformer.h.20.ln_1.weight', 'transformer.h.20.mlp.fc_in.bias', 'transformer.h.20.mlp.fc_in.weight', 'transformer.h.20.mlp.fc_out.bias', 'transformer.h.20.mlp.fc_out.weight', 'transformer.h.21.attn.k_proj.weight', 'transformer.h.21.attn.out_proj.weight', 'transformer.h.21.attn.q_proj.lora_A.weight', 'transformer.h.21.attn.q_proj.lora_B.weight', 'transformer.h.21.attn.q_proj.weight', 'transformer.h.21.attn.v_proj.lora_A.weight', 'transformer.h.21.attn.v_proj.lora_B.weight', 'transformer.h.21.attn.v_proj.weight', 'transformer.h.21.ln_1.bias', 'transformer.h.21.ln_1.weight', 'transformer.h.21.mlp.fc_in.bias', 'transformer.h.21.mlp.fc_in.weight', 'transformer.h.21.mlp.fc_out.bias', 'transformer.h.21.mlp.fc_out.weight', 'transformer.h.22.attn.k_proj.weight', 'transformer.h.22.attn.out_proj.weight', 'transformer.h.22.attn.q_proj.lora_A.weight', 'transformer.h.22.attn.q_proj.lora_B.weight', 'transformer.h.22.attn.q_proj.weight', 'transformer.h.22.attn.v_proj.lora_A.weight', 'transformer.h.22.attn.v_proj.lora_B.weight', 'transformer.h.22.attn.v_proj.weight', 'transformer.h.22.ln_1.bias', 'transformer.h.22.ln_1.weight', 'transformer.h.22.mlp.fc_in.bias', 'transformer.h.22.mlp.fc_in.weight', 'transformer.h.22.mlp.fc_out.bias', 'transformer.h.22.mlp.fc_out.weight', 'transformer.h.23.attn.k_proj.weight', 'transformer.h.23.attn.out_proj.weight', 'transformer.h.23.attn.q_proj.lora_A.weight', 'transformer.h.23.attn.q_proj.lora_B.weight', 'transformer.h.23.attn.q_proj.weight', 'transformer.h.23.attn.v_proj.lora_A.weight', 'transformer.h.23.attn.v_proj.lora_B.weight', 'transformer.h.23.attn.v_proj.weight', 'transformer.h.23.ln_1.bias', 'transformer.h.23.ln_1.weight', 'transformer.h.23.mlp.fc_in.bias', 'transformer.h.23.mlp.fc_in.weight', 'score.weight', 'transformer.h.23.mlp.fc_out.bias', 'transformer.h.23.mlp.fc_out.weight', 'transformer.h.24.attn.k_proj.weight', 'transformer.h.24.attn.out_proj.weight', 'transformer.h.24.attn.q_proj.lora_A.weight', 'transformer.h.24.attn.q_proj.lora_B.weight', 'transformer.h.24.attn.q_proj.weight', 'transformer.h.24.attn.v_proj.lora_A.weight', 'transformer.h.24.attn.v_proj.lora_B.weight', 'transformer.h.24.attn.v_proj.weight', 'transformer.h.24.ln_1.bias', 'transformer.h.24.ln_1.weight', 'transformer.h.24.mlp.fc_in.bias', 'transformer.h.24.mlp.fc_in.weight', 'transformer.h.24.mlp.fc_out.bias', 'transformer.h.24.mlp.fc_out.weight', 'transformer.h.25.attn.k_proj.weight', 'transformer.h.25.attn.out_proj.weight', 'transformer.h.25.attn.q_proj.lora_A.weight', 'transformer.h.25.attn.q_proj.lora_B.weight', 'transformer.h.25.attn.q_proj.weight', 'transformer.h.25.attn.v_proj.lora_A.weight', 'transformer.h.25.attn.v_proj.lora_B.weight', 'transformer.h.25.attn.v_proj.weight', 'transformer.h.25.ln_1.bias', 'transformer.h.25.ln_1.weight', 'transformer.h.25.mlp.fc_in.bias', 'transformer.h.25.mlp.fc_in.weight', 'transformer.h.25.mlp.fc_out.bias', 'transformer.h.25.mlp.fc_out.weight', 'transformer.h.26.attn.k_proj.weight', 'transformer.h.26.attn.out_proj.weight', 'transformer.h.26.attn.q_proj.lora_A.weight', 'transformer.h.26.attn.q_proj.lora_B.weight', 'transformer.h.26.attn.q_proj.weight', 'transformer.h.26.attn.v_proj.lora_A.weight', 'transformer.h.26.attn.v_proj.lora_B.weight', 'transformer.h.26.attn.v_proj.weight', 'transformer.h.26.ln_1.bias', 'transformer.h.26.ln_1.weight', 'transformer.h.26.mlp.fc_in.bias', 'transformer.h.26.mlp.fc_in.weight', 'transformer.h.26.mlp.fc_out.bias', 'transformer.h.26.mlp.fc_out.weight', 'transformer.h.27.attn.k_proj.weight', 'transformer.h.27.attn.out_proj.weight', 'transformer.h.27.attn.q_proj.lora_A.weight', 'transformer.h.27.attn.q_proj.lora_B.weight', 'transformer.h.27.attn.q_proj.weight', 'transformer.h.27.attn.v_proj.lora_A.weight', 'transformer.h.27.attn.v_proj.lora_B.weight', 'transformer.h.27.attn.v_proj.weight', 'transformer.h.27.ln_1.bias', 'transformer.h.27.ln_1.weight', 'transformer.h.27.mlp.fc_in.bias', 'transformer.h.27.mlp.fc_in.weight', 'transformer.h.27.mlp.fc_out.bias', 'transformer.h.27.mlp.fc_out.weight', 'transformer.ln_f.bias', 'transformer.ln_f.weight'])
<frozen importlib._bootstrap>:488: DeprecationWarning: Type google.protobuf.pyext._message.ScalarMapContainer uses PyType_Spec with a metaclass that has custom tp_new. This is deprecated and will no longer be allowed in Python 3.14.
<frozen importlib._bootstrap>:488: DeprecationWarning: Type google.protobuf.pyext._message.MessageMapContainer uses PyType_Spec with a metaclass that has custom tp_new. This is deprecated and will no longer be allowed in Python 3.14.
Activate Layers: transformer.h.0.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.0.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.1.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.1.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.2.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.2.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.3.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.3.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.4.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.4.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.5.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.5.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.6.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.6.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.7.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.7.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.8.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.8.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.9.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.9.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.10.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.10.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.11.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.11.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.12.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.12.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.13.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.13.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.14.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.14.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.15.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.15.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.16.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.16.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.17.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.17.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.18.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.18.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.19.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.19.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.20.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.20.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.21.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.21.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.22.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.22.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.23.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.23.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.24.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.24.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.25.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.25.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.26.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.26.attn.q_proj.lora_A.weight
Activate Layers: transformer.h.27.attn.v_proj.lora_A.weight
Activate Layers: transformer.h.27.attn.q_proj.lora_A.weight
Activate Layers: score.weight
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/sentry_sdk/session.py:51: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  started = datetime.utcnow()
wandb: Currently logged in as: panda12345pa. Use `wandb login --relogin` to force relogin
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/sentry_sdk/session.py:111: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow()
wandb: wandb version 0.18.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/donghao_dev/project/Shared-LoRA-Reward/wandb/run-20240926_051400-90412hbf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ./exp/gpt-j-6b-Reward/lr-5e-5-3epochs-lorar32-user-2/pslora
wandb: ⭐️ View project at https://wandb.ai/panda12345pa/federated%20LoRA
wandb: 🚀 View run at https://wandb.ai/panda12345pa/federated%20LoRA/runs/90412hbf
  0%|          | 0/42 [00:00<?, ?it/s]/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Could not estimate the number of tokens of the input, floating-point operations will not be computed
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:216: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
  2%|▏         | 1/42 [01:21<55:36, 81.38s/it]                                              {'loss': 0.3984, 'grad_norm': 1.113441824913025, 'learning_rate': 1.6302380952380953e-05, 'epoch': 0.02}
  2%|▏         | 1/42 [01:21<55:36, 81.38s/it]  5%|▍         | 2/42 [02:41<53:36, 80.40s/it]                                              {'loss': 0.4268, 'grad_norm': 0.9459909200668335, 'learning_rate': 1.5904761904761902e-05, 'epoch': 0.05}
  5%|▍         | 2/42 [02:41<53:36, 80.40s/it]  7%|▋         | 3/42 [03:59<51:45, 79.62s/it]                                              {'loss': 0.4785, 'grad_norm': 1.1027555465698242, 'learning_rate': 1.5507142857142856e-05, 'epoch': 0.07}
  7%|▋         | 3/42 [03:59<51:45, 79.62s/it] 10%|▉         | 4/42 [05:18<50:12, 79.29s/it]                                              {'loss': 0.4629, 'grad_norm': 0.984714925289154, 'learning_rate': 1.5109523809523809e-05, 'epoch': 0.1}
 10%|▉         | 4/42 [05:18<50:12, 79.29s/it] 12%|█▏        | 5/42 [06:35<48:18, 78.34s/it]                                              {'loss': 0.415, 'grad_norm': 0.9119782447814941, 'learning_rate': 1.471190476190476e-05, 'epoch': 0.12}
 12%|█▏        | 5/42 [06:35<48:18, 78.34s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6367, 0.3633] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9844, 0.0159] │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6602, 0.3418] │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9336, 0.0659] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:02,  3.31s/it][A
  8%|▊         | 3/39 [00:13<02:46,  4.62s/it][A
 10%|█         | 4/39 [00:18<02:55,  5.01s/it][A
 13%|█▎        | 5/39 [00:25<03:07,  5.53s/it][A
 15%|█▌        | 6/39 [00:31<03:12,  5.82s/it][A
 18%|█▊        | 7/39 [00:37<03:11,  5.98s/it][A
 21%|██        | 8/39 [00:44<03:09,  6.12s/it][A
 23%|██▎       | 9/39 [00:50<03:07,  6.26s/it][A
 26%|██▌       | 10/39 [00:57<03:02,  6.29s/it][A
 28%|██▊       | 11/39 [01:03<02:59,  6.40s/it][A
 31%|███       | 12/39 [01:10<02:52,  6.40s/it][A
 33%|███▎      | 13/39 [01:16<02:47,  6.45s/it][A
 36%|███▌      | 14/39 [01:23<02:40,  6.43s/it][A
 38%|███▊      | 15/39 [01:29<02:31,  6.32s/it][A
 41%|████      | 16/39 [01:35<02:26,  6.37s/it][A
 44%|████▎     | 17/39 [01:41<02:15,  6.17s/it][A
 46%|████▌     | 18/39 [01:47<02:10,  6.23s/it][A
 49%|████▊     | 19/39 [01:54<02:06,  6.31s/it][A
 51%|█████▏    | 20/39 [02:00<02:00,  6.37s/it][A
 54%|█████▍    | 21/39 [02:07<01:55,  6.40s/it][A
 56%|█████▋    | 22/39 [02:13<01:47,  6.34s/it][A
 59%|█████▉    | 23/39 [02:20<01:42,  6.43s/it][A
 62%|██████▏   | 24/39 [02:26<01:36,  6.42s/it][A
 64%|██████▍   | 25/39 [02:33<01:30,  6.44s/it][A
 67%|██████▋   | 26/39 [02:39<01:24,  6.46s/it][A
 69%|██████▉   | 27/39 [02:46<01:17,  6.49s/it][A
 72%|███████▏  | 28/39 [02:52<01:11,  6.50s/it][A
 74%|███████▍  | 29/39 [02:59<01:04,  6.50s/it][A
 77%|███████▋  | 30/39 [03:05<00:58,  6.45s/it][A
 79%|███████▉  | 31/39 [03:11<00:50,  6.32s/it][A
 82%|████████▏ | 32/39 [03:18<00:44,  6.37s/it][A
 85%|████████▍ | 33/39 [03:24<00:38,  6.37s/it][A
 87%|████████▋ | 34/39 [03:30<00:32,  6.42s/it][A
 90%|████████▉ | 35/39 [03:37<00:25,  6.44s/it][A
 92%|█████████▏| 36/39 [03:43<00:19,  6.44s/it][A
 95%|█████████▍| 37/39 [03:50<00:12,  6.44s/it][A
 97%|█████████▋| 38/39 [03:56<00:06,  6.23s/it][A
100%|██████████| 39/39 [04:00<00:00,  5.66s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 8 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                              
                                               [A{'eval_loss': 0.6321688294410706, 'eval_accuracy': 0.6575121163166397, 'eval_runtime': 247.0108, 'eval_samples_per_second': 5.012, 'eval_steps_per_second': 0.158, 'epoch': 0.12}
 12%|█▏        | 5/42 [10:49<48:18, 78.34s/it]
100%|██████████| 39/39 [04:00<00:00,  5.66s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 14%|█▍        | 6/42 [12:09<1:39:09, 165.27s/it]                                                 {'loss': 0.4043, 'grad_norm': 1.082747459411621, 'learning_rate': 1.4314285714285713e-05, 'epoch': 0.14}
 14%|█▍        | 6/42 [12:09<1:39:09, 165.27s/it] 17%|█▋        | 7/42 [13:27<1:19:53, 136.95s/it]                                                 {'loss': 0.4971, 'grad_norm': 1.3169665336608887, 'learning_rate': 1.3916666666666667e-05, 'epoch': 0.17}
 17%|█▋        | 7/42 [13:27<1:19:53, 136.95s/it] 19%|█▉        | 8/42 [14:44<1:06:45, 117.81s/it]                                                 {'loss': 0.4521, 'grad_norm': 0.9239534735679626, 'learning_rate': 1.3519047619047618e-05, 'epoch': 0.19}
 19%|█▉        | 8/42 [14:44<1:06:45, 117.81s/it] 21%|██▏       | 9/42 [16:01<57:48, 105.12s/it]                                                 {'loss': 0.4561, 'grad_norm': 1.308886170387268, 'learning_rate': 1.3121428571428571e-05, 'epoch': 0.21}
 21%|██▏       | 9/42 [16:01<57:48, 105.12s/it] 24%|██▍       | 10/42 [17:21<51:48, 97.13s/it]                                               {'loss': 0.4404, 'grad_norm': 1.0888272523880005, 'learning_rate': 1.2723809523809523e-05, 'epoch': 0.24}
 24%|██▍       | 10/42 [17:21<51:48, 97.13s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6367, 0.3633] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9844, 0.0166] │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6641, 0.334]  │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9375, 0.0615] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:03,  3.34s/it][A
  8%|▊         | 3/39 [00:13<02:47,  4.67s/it][A
 10%|█         | 4/39 [00:18<02:57,  5.07s/it][A
 13%|█▎        | 5/39 [00:25<03:09,  5.58s/it][A
 15%|█▌        | 6/39 [00:31<03:13,  5.87s/it][A
 18%|█▊        | 7/39 [00:38<03:13,  6.05s/it][A
 21%|██        | 8/39 [00:44<03:12,  6.20s/it][A
 23%|██▎       | 9/39 [00:51<03:10,  6.35s/it][A
 26%|██▌       | 10/39 [00:58<03:05,  6.38s/it][A
 28%|██▊       | 11/39 [01:04<03:01,  6.48s/it][A
 31%|███       | 12/39 [01:11<02:55,  6.49s/it][A
 33%|███▎      | 13/39 [01:17<02:49,  6.53s/it][A
 36%|███▌      | 14/39 [01:24<02:42,  6.51s/it][A
 38%|███▊      | 15/39 [01:30<02:33,  6.40s/it][A
 41%|████      | 16/39 [01:37<02:28,  6.45s/it][A
 44%|████▎     | 17/39 [01:42<02:17,  6.25s/it][A
 46%|████▌     | 18/39 [01:49<02:12,  6.30s/it][A
 49%|████▊     | 19/39 [01:55<02:07,  6.38s/it][A
 51%|█████▏    | 20/39 [02:02<02:02,  6.42s/it][A
 54%|█████▍    | 21/39 [02:08<01:56,  6.46s/it][A
 56%|█████▋    | 22/39 [02:15<01:48,  6.41s/it][A
 59%|█████▉    | 23/39 [02:21<01:43,  6.50s/it][A
 62%|██████▏   | 24/39 [02:28<01:37,  6.49s/it][A
 64%|██████▍   | 25/39 [02:34<01:31,  6.50s/it][A
 67%|██████▋   | 26/39 [02:41<01:24,  6.50s/it][A
 69%|██████▉   | 27/39 [02:47<01:18,  6.51s/it][A
 72%|███████▏  | 28/39 [02:54<01:11,  6.52s/it][A
 74%|███████▍  | 29/39 [03:00<01:05,  6.51s/it][A
 77%|███████▋  | 30/39 [03:07<00:58,  6.46s/it][A
 79%|███████▉  | 31/39 [03:13<00:50,  6.33s/it][A
 82%|████████▏ | 32/39 [03:19<00:44,  6.38s/it][A
 85%|████████▍ | 33/39 [03:26<00:38,  6.39s/it][A
 87%|████████▋ | 34/39 [03:32<00:32,  6.44s/it][A
 90%|████████▉ | 35/39 [03:39<00:25,  6.46s/it][A
 92%|█████████▏| 36/39 [03:45<00:19,  6.48s/it][A
 95%|█████████▍| 37/39 [03:52<00:12,  6.47s/it][A
 97%|█████████▋| 38/39 [03:57<00:06,  6.25s/it][A
100%|██████████| 39/39 [04:02<00:00,  5.67s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 8 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                               
                                               [A{'eval_loss': 0.6318154335021973, 'eval_accuracy': 0.659935379644588, 'eval_runtime': 248.6928, 'eval_samples_per_second': 4.978, 'eval_steps_per_second': 0.157, 'epoch': 0.24}
 24%|██▍       | 10/42 [21:36<51:48, 97.13s/it]
100%|██████████| 39/39 [04:02<00:00,  5.67s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 26%|██▌       | 11/42 [22:54<1:27:30, 169.38s/it]                                                  {'loss': 0.4365, 'grad_norm': 1.0347161293029785, 'learning_rate': 1.2326190476190476e-05, 'epoch': 0.26}
 26%|██▌       | 11/42 [22:54<1:27:30, 169.38s/it] 29%|██▊       | 12/42 [24:13<1:10:53, 141.78s/it]                                                  {'loss': 0.5518, 'grad_norm': 1.382656216621399, 'learning_rate': 1.1928571428571428e-05, 'epoch': 0.29}
 29%|██▊       | 12/42 [24:13<1:10:53, 141.78s/it] 31%|███       | 13/42 [25:31<59:17, 122.66s/it]                                                  {'loss': 0.4375, 'grad_norm': 1.1843442916870117, 'learning_rate': 1.153095238095238e-05, 'epoch': 0.31}
 31%|███       | 13/42 [25:31<59:17, 122.66s/it] 33%|███▎      | 14/42 [26:49<50:52, 109.01s/it]                                                {'loss': 0.4473, 'grad_norm': 1.0398619174957275, 'learning_rate': 1.1133333333333332e-05, 'epoch': 0.33}
 33%|███▎      | 14/42 [26:49<50:52, 109.01s/it] 36%|███▌      | 15/42 [28:07<44:51, 99.70s/it]                                                {'loss': 0.4512, 'grad_norm': 0.875426173210144, 'learning_rate': 1.0735714285714286e-05, 'epoch': 0.36}
 36%|███▌      | 15/42 [28:07<44:51, 99.70s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6211, 0.377]  │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9844, 0.015]  │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6641, 0.334]  │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9414, 0.0601] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:03,  3.34s/it][A
  8%|▊         | 3/39 [00:13<02:47,  4.64s/it][A
 10%|█         | 4/39 [00:18<02:56,  5.04s/it][A
 13%|█▎        | 5/39 [00:25<03:08,  5.54s/it][A
 15%|█▌        | 6/39 [00:31<03:12,  5.83s/it][A
 18%|█▊        | 7/39 [00:38<03:11,  5.99s/it][A
 21%|██        | 8/39 [00:44<03:10,  6.15s/it][A
 23%|██▎       | 9/39 [00:51<03:08,  6.29s/it][A
 26%|██▌       | 10/39 [00:57<03:03,  6.32s/it][A
 28%|██▊       | 11/39 [01:04<02:59,  6.41s/it][A
 31%|███       | 12/39 [01:10<02:53,  6.42s/it][A
 33%|███▎      | 13/39 [01:17<02:48,  6.47s/it][A
 36%|███▌      | 14/39 [01:23<02:41,  6.45s/it][A
 38%|███▊      | 15/39 [01:29<02:31,  6.33s/it][A
 41%|████      | 16/39 [01:36<02:26,  6.38s/it][A
 44%|████▎     | 17/39 [01:41<02:16,  6.20s/it][A
 46%|████▌     | 18/39 [01:48<02:11,  6.26s/it][A
 49%|████▊     | 19/39 [01:54<02:06,  6.33s/it][A
 51%|█████▏    | 20/39 [02:01<02:01,  6.38s/it][A
 54%|█████▍    | 21/39 [02:07<01:55,  6.40s/it][A
 56%|█████▋    | 22/39 [02:13<01:47,  6.34s/it][A
 59%|█████▉    | 23/39 [02:20<01:42,  6.43s/it][A
 62%|██████▏   | 24/39 [02:27<01:36,  6.42s/it][A
 64%|██████▍   | 25/39 [02:33<01:30,  6.44s/it][A
 67%|██████▋   | 26/39 [02:39<01:23,  6.45s/it][A
 69%|██████▉   | 27/39 [02:46<01:17,  6.46s/it][A
 72%|███████▏  | 28/39 [02:52<01:11,  6.47s/it][A
 74%|███████▍  | 29/39 [02:59<01:04,  6.47s/it][A
 77%|███████▋  | 30/39 [03:05<00:57,  6.43s/it][A
 79%|███████▉  | 31/39 [03:11<00:50,  6.30s/it][A
 82%|████████▏ | 32/39 [03:18<00:44,  6.34s/it][A
 85%|████████▍ | 33/39 [03:24<00:38,  6.34s/it][A
 87%|████████▋ | 34/39 [03:31<00:31,  6.39s/it][A
 90%|████████▉ | 35/39 [03:37<00:25,  6.42s/it][A
 92%|█████████▏| 36/39 [03:44<00:19,  6.44s/it][A
 95%|█████████▍| 37/39 [03:50<00:12,  6.44s/it][A
 97%|█████████▋| 38/39 [03:56<00:06,  6.22s/it][A
100%|██████████| 39/39 [04:00<00:00,  5.65s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 6 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                               
                                               [A{'eval_loss': 0.6306164264678955, 'eval_accuracy': 0.6607431340872375, 'eval_runtime': 246.8994, 'eval_samples_per_second': 5.014, 'eval_steps_per_second': 0.158, 'epoch': 0.36}
 36%|███▌      | 15/42 [32:20<44:51, 99.70s/it]
100%|██████████| 39/39 [04:00<00:00,  5.65s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 38%|███▊      | 16/42 [33:39<1:13:28, 169.55s/it]                                                  {'loss': 0.4531, 'grad_norm': 1.1492255926132202, 'learning_rate': 1.0338095238095239e-05, 'epoch': 0.38}
 38%|███▊      | 16/42 [33:39<1:13:28, 169.55s/it] 40%|████      | 17/42 [34:58<59:18, 142.34s/it]                                                  {'loss': 0.4736, 'grad_norm': 1.038165807723999, 'learning_rate': 9.94047619047619e-06, 'epoch': 0.4}
 40%|████      | 17/42 [34:58<59:18, 142.34s/it] 43%|████▎     | 18/42 [36:16<49:11, 122.98s/it]                                                {'loss': 0.5088, 'grad_norm': 1.123659372329712, 'learning_rate': 9.542857142857142e-06, 'epoch': 0.43}
 43%|████▎     | 18/42 [36:16<49:11, 122.98s/it] 45%|████▌     | 19/42 [37:34<42:04, 109.76s/it]                                                {'loss': 0.502, 'grad_norm': 1.078682780265808, 'learning_rate': 9.145238095238095e-06, 'epoch': 0.45}
 45%|████▌     | 19/42 [37:34<42:04, 109.76s/it] 48%|████▊     | 20/42 [38:52<36:42, 100.11s/it]                                                {'loss': 0.4707, 'grad_norm': 1.0706048011779785, 'learning_rate': 8.747619047619048e-06, 'epoch': 0.48}
 48%|████▊     | 20/42 [38:52<36:42, 100.11s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6445, 0.3555] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9844, 0.0156] │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6641, 0.334]  │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9375, 0.063]  │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:02,  3.31s/it][A
  8%|▊         | 3/39 [00:13<02:45,  4.60s/it][A
 10%|█         | 4/39 [00:18<02:54,  5.00s/it][A
 13%|█▎        | 5/39 [00:25<03:06,  5.50s/it][A
 15%|█▌        | 6/39 [00:31<03:10,  5.78s/it][A
 18%|█▊        | 7/39 [00:37<03:10,  5.94s/it][A
 21%|██        | 8/39 [00:44<03:08,  6.10s/it][A
 23%|██▎       | 9/39 [00:50<03:07,  6.24s/it][A
 26%|██▌       | 10/39 [00:57<03:02,  6.28s/it][A
 28%|██▊       | 11/39 [01:03<02:58,  6.37s/it][A
 31%|███       | 12/39 [01:10<02:51,  6.36s/it][A
 33%|███▎      | 13/39 [01:16<02:46,  6.41s/it][A
 36%|███▌      | 14/39 [01:22<02:39,  6.40s/it][A
 38%|███▊      | 15/39 [01:28<02:30,  6.28s/it][A
 41%|████      | 16/39 [01:35<02:25,  6.33s/it][A
 44%|████▎     | 17/39 [01:41<02:14,  6.14s/it][A
 46%|████▌     | 18/39 [01:47<02:09,  6.19s/it][A
 49%|████▊     | 19/39 [01:53<02:05,  6.26s/it][A
 51%|█████▏    | 20/39 [02:00<02:00,  6.33s/it][A
 54%|█████▍    | 21/39 [02:06<01:54,  6.37s/it][A
 56%|█████▋    | 22/39 [02:12<01:47,  6.31s/it][A
 59%|█████▉    | 23/39 [02:19<01:42,  6.40s/it][A
 62%|██████▏   | 24/39 [02:25<01:35,  6.38s/it][A
 64%|██████▍   | 25/39 [02:32<01:29,  6.40s/it][A
 67%|██████▋   | 26/39 [02:38<01:23,  6.41s/it][A
 69%|██████▉   | 27/39 [02:45<01:17,  6.43s/it][A
 72%|███████▏  | 28/39 [02:51<01:10,  6.43s/it][A
 74%|███████▍  | 29/39 [02:58<01:04,  6.43s/it][A
 77%|███████▋  | 30/39 [03:04<00:57,  6.38s/it][A
 79%|███████▉  | 31/39 [03:10<00:50,  6.25s/it][A
 82%|████████▏ | 32/39 [03:16<00:44,  6.30s/it][A
 85%|████████▍ | 33/39 [03:23<00:37,  6.31s/it][A
 87%|████████▋ | 34/39 [03:29<00:31,  6.35s/it][A
 90%|████████▉ | 35/39 [03:35<00:25,  6.39s/it][A
 92%|█████████▏| 36/39 [03:42<00:19,  6.40s/it][A
 95%|█████████▍| 37/39 [03:48<00:12,  6.39s/it][A
 97%|█████████▋| 38/39 [03:54<00:06,  6.17s/it][A
100%|██████████| 39/39 [03:58<00:00,  5.61s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 8 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                                
                                               [A{'eval_loss': 0.6316261291503906, 'eval_accuracy': 0.6607431340872375, 'eval_runtime': 245.124, 'eval_samples_per_second': 5.051, 'eval_steps_per_second': 0.159, 'epoch': 0.48}
 48%|████▊     | 20/42 [43:04<36:42, 100.11s/it]
100%|██████████| 39/39 [03:58<00:00,  5.61s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 50%|█████     | 21/42 [44:20<58:59, 168.53s/it]                                                {'loss': 0.4385, 'grad_norm': 0.9638833999633789, 'learning_rate': 8.35e-06, 'epoch': 0.5}
 50%|█████     | 21/42 [44:20<58:59, 168.53s/it] 52%|█████▏    | 22/42 [45:39<47:10, 141.51s/it]                                                {'loss': 0.4404, 'grad_norm': 1.1419259309768677, 'learning_rate': 7.952380952380951e-06, 'epoch': 0.52}
 52%|█████▏    | 22/42 [45:39<47:10, 141.51s/it] 55%|█████▍    | 23/42 [46:59<38:59, 123.11s/it]                                                {'loss': 0.4014, 'grad_norm': 0.8606381416320801, 'learning_rate': 7.554761904761904e-06, 'epoch': 0.55}
 55%|█████▍    | 23/42 [46:59<38:59, 123.11s/it] 57%|█████▋    | 24/42 [48:17<32:54, 109.67s/it]                                                {'loss': 0.4395, 'grad_norm': 1.0197306871414185, 'learning_rate': 7.157142857142857e-06, 'epoch': 0.57}
 57%|█████▋    | 24/42 [48:17<32:54, 109.67s/it] 60%|█████▉    | 25/42 [49:36<28:27, 100.45s/it]                                                {'loss': 0.4229, 'grad_norm': 0.9898993372917175, 'learning_rate': 6.759523809523809e-06, 'epoch': 0.6}
 60%|█████▉    | 25/42 [49:36<28:27, 100.45s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6445, 0.3555] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9844, 0.0143] │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6719, 0.3281] │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9414, 0.0605] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:02,  3.32s/it][A
  8%|▊         | 3/39 [00:13<02:45,  4.60s/it][A
 10%|█         | 4/39 [00:18<02:54,  5.00s/it][A
 13%|█▎        | 5/39 [00:25<03:07,  5.50s/it][A
 15%|█▌        | 6/39 [00:31<03:10,  5.79s/it][A
 18%|█▊        | 7/39 [00:37<03:10,  5.94s/it][A
 21%|██        | 8/39 [00:44<03:08,  6.09s/it][A
 23%|██▎       | 9/39 [00:50<03:06,  6.23s/it][A
 26%|██▌       | 10/39 [00:57<03:01,  6.26s/it][A
 28%|██▊       | 11/39 [01:03<02:58,  6.37s/it][A
 31%|███       | 12/39 [01:10<02:51,  6.37s/it][A
 33%|███▎      | 13/39 [01:16<02:46,  6.41s/it][A
 36%|███▌      | 14/39 [01:22<02:40,  6.41s/it][A
 38%|███▊      | 15/39 [01:28<02:31,  6.30s/it][A
 41%|████      | 16/39 [01:35<02:25,  6.34s/it][A
 44%|████▎     | 17/39 [01:41<02:15,  6.15s/it][A
 46%|████▌     | 18/39 [01:47<02:10,  6.21s/it][A
 49%|████▊     | 19/39 [01:53<02:05,  6.28s/it][A
 51%|█████▏    | 20/39 [02:00<02:00,  6.34s/it][A
 54%|█████▍    | 21/39 [02:06<01:54,  6.39s/it][A
 56%|█████▋    | 22/39 [02:13<01:47,  6.33s/it][A
 59%|█████▉    | 23/39 [02:19<01:42,  6.42s/it][A
 62%|██████▏   | 24/39 [02:26<01:36,  6.40s/it][A
 64%|██████▍   | 25/39 [02:32<01:30,  6.44s/it][A
 67%|██████▋   | 26/39 [02:39<01:23,  6.44s/it][A
 69%|██████▉   | 27/39 [02:45<01:17,  6.45s/it][A
 72%|███████▏  | 28/39 [02:51<01:10,  6.45s/it][A
 74%|███████▍  | 29/39 [02:58<01:04,  6.45s/it][A
 77%|███████▋  | 30/39 [03:04<00:57,  6.41s/it][A
 79%|███████▉  | 31/39 [03:10<00:50,  6.28s/it][A
 82%|████████▏ | 32/39 [03:17<00:44,  6.34s/it][A
 85%|████████▍ | 33/39 [03:23<00:38,  6.36s/it][A
 87%|████████▋ | 34/39 [03:30<00:32,  6.42s/it][A
 90%|████████▉ | 35/39 [03:36<00:25,  6.45s/it][A
 92%|█████████▏| 36/39 [03:43<00:19,  6.47s/it][A
 95%|█████████▍| 37/39 [03:49<00:12,  6.46s/it][A
 97%|█████████▋| 38/39 [03:55<00:06,  6.23s/it][A
100%|██████████| 39/39 [03:59<00:00,  5.66s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 6 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                                
                                               [A{'eval_loss': 0.6309698224067688, 'eval_accuracy': 0.659935379644588, 'eval_runtime': 246.1149, 'eval_samples_per_second': 5.03, 'eval_steps_per_second': 0.158, 'epoch': 0.6}
 60%|█████▉    | 25/42 [53:49<28:27, 100.45s/it]
100%|██████████| 39/39 [03:59<00:00,  5.66s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 62%|██████▏   | 26/42 [55:08<45:18, 169.92s/it]                                                {'loss': 0.415, 'grad_norm': 1.0200401544570923, 'learning_rate': 6.3619047619047615e-06, 'epoch': 0.62}
 62%|██████▏   | 26/42 [55:08<45:18, 169.92s/it] 64%|██████▍   | 27/42 [56:31<35:56, 143.79s/it]                                                {'loss': 0.3984, 'grad_norm': 0.9499020576477051, 'learning_rate': 5.964285714285714e-06, 'epoch': 0.64}
 64%|██████▍   | 27/42 [56:31<35:56, 143.79s/it] 67%|██████▋   | 28/42 [57:48<28:53, 123.84s/it]                                                {'loss': 0.4473, 'grad_norm': 1.0294134616851807, 'learning_rate': 5.566666666666666e-06, 'epoch': 0.67}
 67%|██████▋   | 28/42 [57:48<28:53, 123.84s/it] 69%|██████▉   | 29/42 [59:05<23:45, 109.64s/it]                                                {'loss': 0.4854, 'grad_norm': 0.9466814994812012, 'learning_rate': 5.169047619047619e-06, 'epoch': 0.69}
 69%|██████▉   | 29/42 [59:05<23:45, 109.64s/it] 71%|███████▏  | 30/42 [1:00:25<20:10, 100.84s/it]                                                  {'loss': 0.4551, 'grad_norm': 0.8956320881843567, 'learning_rate': 4.771428571428571e-06, 'epoch': 0.71}
 71%|███████▏  | 30/42 [1:00:25<20:10, 100.84s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6367, 0.3633] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9844, 0.014]  │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6719, 0.3281] │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9414, 0.0574] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:02,  3.31s/it][A
  8%|▊         | 3/39 [00:13<02:46,  4.62s/it][A
 10%|█         | 4/39 [00:18<02:55,  5.03s/it][A
 13%|█▎        | 5/39 [00:25<03:08,  5.54s/it][A
 15%|█▌        | 6/39 [00:31<03:12,  5.82s/it][A
 18%|█▊        | 7/39 [00:37<03:11,  5.98s/it][A
 21%|██        | 8/39 [00:44<03:10,  6.13s/it][A
 23%|██▎       | 9/39 [00:51<03:08,  6.30s/it][A
 26%|██▌       | 10/39 [00:57<03:03,  6.34s/it][A
 28%|██▊       | 11/39 [01:04<02:59,  6.42s/it][A
 31%|███       | 12/39 [01:10<02:53,  6.42s/it][A
 33%|███▎      | 13/39 [01:17<02:47,  6.46s/it][A
 36%|███▌      | 14/39 [01:23<02:41,  6.45s/it][A
 38%|███▊      | 15/39 [01:29<02:32,  6.33s/it][A
 41%|████      | 16/39 [01:36<02:26,  6.38s/it][A
 44%|████▎     | 17/39 [01:41<02:16,  6.18s/it][A
 46%|████▌     | 18/39 [01:48<02:10,  6.24s/it][A
 49%|████▊     | 19/39 [01:54<02:06,  6.32s/it][A
 51%|█████▏    | 20/39 [02:01<02:01,  6.38s/it][A
 54%|█████▍    | 21/39 [02:07<01:55,  6.42s/it][A
 56%|█████▋    | 22/39 [02:13<01:47,  6.35s/it][A
 59%|█████▉    | 23/39 [02:20<01:42,  6.44s/it][A
 62%|██████▏   | 24/39 [02:26<01:36,  6.42s/it][A
 64%|██████▍   | 25/39 [02:33<01:30,  6.45s/it][A
 67%|██████▋   | 26/39 [02:39<01:23,  6.46s/it][A
 69%|██████▉   | 27/39 [02:46<01:17,  6.48s/it][A
 72%|███████▏  | 28/39 [02:52<01:11,  6.49s/it][A
 74%|███████▍  | 29/39 [02:59<01:05,  6.50s/it][A
 77%|███████▋  | 30/39 [03:05<00:58,  6.45s/it][A
 79%|███████▉  | 31/39 [03:11<00:50,  6.32s/it][A
 82%|████████▏ | 32/39 [03:18<00:44,  6.39s/it][A
 85%|████████▍ | 33/39 [03:24<00:38,  6.41s/it][A
 87%|████████▋ | 34/39 [03:31<00:32,  6.47s/it][A
 90%|████████▉ | 35/39 [03:38<00:26,  6.50s/it][A
 92%|█████████▏| 36/39 [03:44<00:19,  6.52s/it][A
 95%|█████████▍| 37/39 [03:51<00:13,  6.51s/it][A
 97%|█████████▋| 38/39 [03:56<00:06,  6.29s/it][A
100%|██████████| 39/39 [04:01<00:00,  5.70s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 3 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                                  
                                               [A{'eval_loss': 0.6314746737480164, 'eval_accuracy': 0.6583198707592892, 'eval_runtime': 247.7252, 'eval_samples_per_second': 4.997, 'eval_steps_per_second': 0.157, 'epoch': 0.71}
 71%|███████▏  | 30/42 [1:04:40<20:10, 100.84s/it]
100%|██████████| 39/39 [04:01<00:00,  5.70s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 74%|███████▍  | 31/42 [1:05:57<31:12, 170.27s/it]                                                  {'loss': 0.4717, 'grad_norm': 0.9818053245544434, 'learning_rate': 4.373809523809524e-06, 'epoch': 0.74}
 74%|███████▍  | 31/42 [1:05:57<31:12, 170.27s/it] 76%|███████▌  | 32/42 [1:07:18<23:53, 143.32s/it]                                                  {'loss': 0.5508, 'grad_norm': 1.3392585515975952, 'learning_rate': 3.976190476190476e-06, 'epoch': 0.76}
 76%|███████▌  | 32/42 [1:07:18<23:53, 143.32s/it] 79%|███████▊  | 33/42 [1:08:38<18:39, 124.36s/it]                                                  {'loss': 0.4609, 'grad_norm': 1.118726134300232, 'learning_rate': 3.5785714285714284e-06, 'epoch': 0.79}
 79%|███████▊  | 33/42 [1:08:38<18:39, 124.36s/it] 81%|████████  | 34/42 [1:09:56<14:44, 110.62s/it]                                                  {'loss': 0.4004, 'grad_norm': 0.9067248106002808, 'learning_rate': 3.1809523809523807e-06, 'epoch': 0.81}
 81%|████████  | 34/42 [1:09:56<14:44, 110.62s/it] 83%|████████▎ | 35/42 [1:11:15<11:47, 101.00s/it]                                                  {'loss': 0.4336, 'grad_norm': 1.1534297466278076, 'learning_rate': 2.783333333333333e-06, 'epoch': 0.83}
 83%|████████▎ | 35/42 [1:11:15<11:47, 101.00s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6445, 0.3555] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9883, 0.0136] │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6797, 0.3203] │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9375, 0.0615] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:03,  3.34s/it][A
  8%|▊         | 3/39 [00:13<02:47,  4.65s/it][A
 10%|█         | 4/39 [00:18<02:56,  5.04s/it][A
 13%|█▎        | 5/39 [00:25<03:08,  5.56s/it][A
 15%|█▌        | 6/39 [00:31<03:12,  5.84s/it][A
 18%|█▊        | 7/39 [00:38<03:12,  6.00s/it][A
 21%|██        | 8/39 [00:44<03:10,  6.15s/it][A
 23%|██▎       | 9/39 [00:51<03:08,  6.30s/it][A
 26%|██▌       | 10/39 [00:57<03:03,  6.33s/it][A
 28%|██▊       | 11/39 [01:04<03:00,  6.43s/it][A
 31%|███       | 12/39 [01:10<02:53,  6.43s/it][A
 33%|███▎      | 13/39 [01:17<02:48,  6.48s/it][A
 36%|███▌      | 14/39 [01:23<02:41,  6.46s/it][A
 38%|███▊      | 15/39 [01:29<02:32,  6.35s/it][A
 41%|████      | 16/39 [01:36<02:27,  6.39s/it][A
 44%|████▎     | 17/39 [01:42<02:16,  6.20s/it][A
 46%|████▌     | 18/39 [01:48<02:11,  6.26s/it][A
 49%|████▊     | 19/39 [01:54<02:06,  6.33s/it][A
 51%|█████▏    | 20/39 [02:01<02:01,  6.37s/it][A
 54%|█████▍    | 21/39 [02:07<01:55,  6.41s/it][A
 56%|█████▋    | 22/39 [02:14<01:47,  6.35s/it][A
 59%|█████▉    | 23/39 [02:20<01:43,  6.45s/it][A
 62%|██████▏   | 24/39 [02:27<01:36,  6.44s/it][A
 64%|██████▍   | 25/39 [02:33<01:30,  6.47s/it][A
 67%|██████▋   | 26/39 [02:40<01:24,  6.47s/it][A
 69%|██████▉   | 27/39 [02:46<01:17,  6.49s/it][A
 72%|███████▏  | 28/39 [02:53<01:11,  6.50s/it][A
 74%|███████▍  | 29/39 [02:59<01:04,  6.49s/it][A
 77%|███████▋  | 30/39 [03:06<00:58,  6.45s/it][A
 79%|███████▉  | 31/39 [03:12<00:50,  6.32s/it][A
 82%|████████▏ | 32/39 [03:18<00:44,  6.37s/it][A
 85%|████████▍ | 33/39 [03:25<00:38,  6.38s/it][A
 87%|████████▋ | 34/39 [03:31<00:32,  6.43s/it][A
 90%|████████▉ | 35/39 [03:38<00:25,  6.46s/it][A
 92%|█████████▏| 36/39 [03:44<00:19,  6.46s/it][A
 95%|█████████▍| 37/39 [03:51<00:12,  6.45s/it][A
 97%|█████████▋| 38/39 [03:56<00:06,  6.23s/it][A
100%|██████████| 39/39 [04:01<00:00,  5.66s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 7 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                                  
                                               [A{'eval_loss': 0.6311717629432678, 'eval_accuracy': 0.659935379644588, 'eval_runtime': 247.5132, 'eval_samples_per_second': 5.002, 'eval_steps_per_second': 0.158, 'epoch': 0.83}
 83%|████████▎ | 35/42 [1:15:29<11:47, 101.00s/it]
100%|██████████| 39/39 [04:01<00:00,  5.66s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 86%|████████▌ | 36/42 [1:16:50<17:06, 171.07s/it]                                                  {'loss': 0.4668, 'grad_norm': 1.0519535541534424, 'learning_rate': 2.3857142857142854e-06, 'epoch': 0.86}
 86%|████████▌ | 36/42 [1:16:50<17:06, 171.07s/it] 88%|████████▊ | 37/42 [1:18:08<11:55, 143.15s/it]                                                  {'loss': 0.415, 'grad_norm': 1.146409273147583, 'learning_rate': 1.988095238095238e-06, 'epoch': 0.88}
 88%|████████▊ | 37/42 [1:18:08<11:55, 143.15s/it] 90%|█████████ | 38/42 [1:19:26<08:15, 123.82s/it]                                                  {'loss': 0.4521, 'grad_norm': 0.8915040493011475, 'learning_rate': 1.5904761904761904e-06, 'epoch': 0.9}
 90%|█████████ | 38/42 [1:19:26<08:15, 123.82s/it] 93%|█████████▎| 39/42 [1:20:46<05:32, 110.69s/it]                                                  {'loss': 0.5, 'grad_norm': 1.1831443309783936, 'learning_rate': 1.1928571428571427e-06, 'epoch': 0.93}
 93%|█████████▎| 39/42 [1:20:46<05:32, 110.69s/it] 95%|█████████▌| 40/42 [1:22:06<03:22, 101.26s/it]                                                  {'loss': 0.4785, 'grad_norm': 0.921326756477356, 'learning_rate': 7.952380952380952e-07, 'epoch': 0.95}
 95%|█████████▌| 40/42 [1:22:06<03:22, 101.26s/it]┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6523, 0.3496] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9883, 0.0126] │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6602, 0.3418] │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9414, 0.0571] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())

  0%|          | 0/39 [00:00<?, ?it/s][A
  5%|▌         | 2/39 [00:06<02:02,  3.32s/it][A
  8%|▊         | 3/39 [00:13<02:46,  4.62s/it][A
 10%|█         | 4/39 [00:18<02:56,  5.03s/it][A
 13%|█▎        | 5/39 [00:25<03:08,  5.54s/it][A
 15%|█▌        | 6/39 [00:31<03:12,  5.82s/it][A
 18%|█▊        | 7/39 [00:37<03:11,  5.98s/it][A
 21%|██        | 8/39 [00:44<03:10,  6.13s/it][A
 23%|██▎       | 9/39 [00:51<03:08,  6.27s/it][A
 26%|██▌       | 10/39 [00:57<03:03,  6.32s/it][A
 28%|██▊       | 11/39 [01:04<02:59,  6.41s/it][A
 31%|███       | 12/39 [01:10<02:53,  6.41s/it][A
 33%|███▎      | 13/39 [01:17<02:47,  6.45s/it][A
 36%|███▌      | 14/39 [01:23<02:40,  6.43s/it][A
 38%|███▊      | 15/39 [01:29<02:31,  6.32s/it][A
 41%|████      | 16/39 [01:35<02:26,  6.35s/it][A
 44%|████▎     | 17/39 [01:41<02:15,  6.16s/it][A
 46%|████▌     | 18/39 [01:47<02:10,  6.20s/it][A
 49%|████▊     | 19/39 [01:54<02:05,  6.27s/it][A
 51%|█████▏    | 20/39 [02:00<02:00,  6.33s/it][A
 54%|█████▍    | 21/39 [02:07<01:54,  6.38s/it][A
 56%|█████▋    | 22/39 [02:13<01:47,  6.32s/it][A
 59%|█████▉    | 23/39 [02:20<01:42,  6.42s/it][A
 62%|██████▏   | 24/39 [02:26<01:36,  6.42s/it][A
 64%|██████▍   | 25/39 [02:33<01:30,  6.44s/it][A
 67%|██████▋   | 26/39 [02:39<01:23,  6.45s/it][A
 69%|██████▉   | 27/39 [02:46<01:17,  6.47s/it][A
 72%|███████▏  | 28/39 [02:52<01:11,  6.48s/it][A
 74%|███████▍  | 29/39 [02:59<01:04,  6.47s/it][A
 77%|███████▋  | 30/39 [03:05<00:57,  6.42s/it][A
 79%|███████▉  | 31/39 [03:11<00:50,  6.30s/it][A
 82%|████████▏ | 32/39 [03:17<00:44,  6.35s/it][A
 85%|████████▍ | 33/39 [03:24<00:38,  6.37s/it][A
 87%|████████▋ | 34/39 [03:30<00:32,  6.42s/it][A
 90%|████████▉ | 35/39 [03:37<00:25,  6.45s/it][A
 92%|█████████▏| 36/39 [03:43<00:19,  6.46s/it][A
 95%|█████████▍| 37/39 [03:50<00:12,  6.45s/it][A
 97%|█████████▋| 38/39 [03:55<00:06,  6.22s/it][A
100%|██████████| 39/39 [04:00<00:00,  5.65s/it][A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 5 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
                                                  
                                               [A{'eval_loss': 0.630515456199646, 'eval_accuracy': 0.6575121163166397, 'eval_runtime': 246.6075, 'eval_samples_per_second': 5.02, 'eval_steps_per_second': 0.158, 'epoch': 0.95}
 95%|█████████▌| 40/42 [1:26:19<03:22, 101.26s/it]
100%|██████████| 39/39 [04:00<00:00,  5.65s/it][A
                                               [A/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
 98%|█████████▊| 41/42 [1:27:37<02:50, 170.39s/it]                                                  {'loss': 0.4297, 'grad_norm': 0.888864278793335, 'learning_rate': 3.976190476190476e-07, 'epoch': 0.98}
 98%|█████████▊| 41/42 [1:27:37<02:50, 170.39s/it]100%|██████████| 42/42 [1:28:53<00:00, 142.06s/it]                                                  {'loss': 0.4424, 'grad_norm': 0.7707189321517944, 'learning_rate': 0.0, 'epoch': 1.0}
100%|██████████| 42/42 [1:28:53<00:00, 142.06s/it]                                                  {'train_runtime': 5519.5997, 'train_samples_per_second': 0.973, 'train_steps_per_second': 0.008, 'train_loss': 0.45261346726190477, 'epoch': 1.0}
100%|██████████| 42/42 [1:31:51<00:00, 142.06s/it]100%|██████████| 42/42 [1:31:51<00:00, 131.23s/it]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ chosen_text                 ┃ rejected_text               ┃ logits           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ SUBREDDIT: r/tifu           │ SUBREDDIT: r/tifu           │ [0.6289, 0.3711] │
│ TITLE: TIFU by zoning out   │ TITLE: TIFU by zoning out   │                  │
│ in class                    │ in class                    │                  │
│ POST: So I'm sitting in     │ POST: So I'm sitting in     │                  │
│ Spanish class going off of  │ Spanish class going off of  │                  │
│ 4 hours of sleep from       │ 4 hours of sleep from       │                  │
│ staying up all night        │ staying up all night        │                  │
│ preparing my chemistry lab. │ preparing my chemistry lab. │                  │
│ We were doing a group       │ We were doing a group       │                  │
│ activity where we had to go │ activity where we had to go │                  │
│ around the room             │ around the room             │                  │
│ interviewing people in      │ interviewing people in      │                  │
│ Spanish about their name,   │ Spanish about their name,   │                  │
│ home town, phone number,    │ home town, phone number,    │                  │
│ etc. I finished before      │ etc. I finished before      │                  │
│ everyone else so I sit back │ everyone else so I sit back │                  │
│ down and wait for class to  │ down and wait for class to  │                  │
│ get over (about 2 minutes   │ get over (about 2 minutes   │                  │
│ left). My professor gets my │ left). My professor gets my │                  │
│ attention and asks me to    │ attention and asks me to    │                  │
│ read out loud to the class. │ read out loud to the class. │                  │
│ Unfortunately in my         │ Unfortunately in my         │                  │
│ hungover like state of mind │ hungover like state of mind │                  │
│ from lack of sleep I failed │ from lack of sleep I failed │                  │
│ to recognize what he said   │ to recognize what he said   │                  │
│ to me and sat there looking │ to me and sat there looking │                  │
│ dumbfounded at my           │ dumbfounded at my           │                  │
│ professor. A good 30        │ professor. A good 30        │                  │
│ seconds to a minute goes by │ seconds to a minute goes by │                  │
│ before he asks me again,    │ before he asks me again,    │                  │
│ and again I space out. Not  │ and again I space out. Not  │                  │
│ sure of what I should do, I │ sure of what I should do, I │                  │
│ turn around and start       │ turn around and start       │                  │
│ reading my interview to a   │ reading my interview to a   │                  │
│ friend of mine behind me.   │ friend of mine behind me.   │                  │
│ At this point the entire    │ At this point the entire    │                  │
│ class is silent as I'm      │ class is silent as I'm      │                  │
│ whispering my interview to  │ whispering my interview to  │                  │
│ my friend, who finally      │ my friend, who finally      │                  │
│ points me to look at the    │ points me to look at the    │                  │
│ professor who again says    │ professor who again says    │                  │
│ "READ TO THE CLASS". I turn │ "READ TO THE CLASS". I turn │                  │
│ around and finally          │ around and finally          │                  │
│ understand what he wanted   │ understand what he wanted   │                  │
│ me to do, right as time     │ me to do, right as time     │                  │
│ runs out for class.         │ runs out for class.         │                  │
│ TL;DR:  In Spanish class    │ TL;DR:  Was hungover from   │                  │
│ from lack of sleep, failed  │ lack of sleep and missed    │                  │
│ to recognize my professor's │ professor's instructions in │                  │
│ instructions to read out    │ Spanish class, had to read  │                  │
│ loud and ended up           │ to the class while          │                  │
│ whispering my interview to  │ whispering to my friend,    │                  │
│ a friend instead.           │ time ran out before I       │                  │
│                             │ finished.                   │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9883, 0.0136] │
│ TITLE: Pursuing a           │ TITLE: Pursuing a           │                  │
│ friendship then more.       │ friendship then more.       │                  │
│ POST: I'm a 19 yr old male. │ POST: I'm a 19 yr old male. │                  │
│ I really like this girl(18  │ I really like this girl(18  │                  │
│ yr). I met her through a    │ yr). I met her through a    │                  │
│ friend and have a hungout   │ friend and have a hungout   │                  │
│ with her a couple times. We │ with her a couple times. We │                  │
│ get along well and have     │ get along well and have     │                  │
│ similar personalities.  The │ similar personalities.  The │                  │
│ main contact I have is      │ main contact I have is      │                  │
│ through social media:       │ through social media:       │                  │
│ twitter, snapchat and text. │ twitter, snapchat and text. │                  │
│ Our conversations usually   │ Our conversations usually   │                  │
│ don't last long except one  │ don't last long except one  │                  │
│ occasion when we discussed  │ occasion when we discussed  │                  │
│ a serious topic of          │ a serious topic of          │                  │
│ depression and shared how   │ depression and shared how   │                  │
│ we've had our moments. So   │ we've had our moments. So   │                  │
│ we connected on another     │ we connected on another     │                  │
│ level (so I thought).       │ level (so I thought).       │                  │
│ Anyway the question is how  │ Anyway the question is how  │                  │
│ can I pursue a friendship   │ can I pursue a friendship   │                  │
│ then more if she won't talk │ then more if she won't talk │                  │
│ to me much. Is she ignoring │ to me much. Is she ignoring │                  │
│ me or just a busy person? I │ me or just a busy person? I │                  │
│ feel like we could have     │ feel like we could have     │                  │
│ something if we tried.      │ something if we tried.      │                  │
│ TL;DR:  Like this girl.     │ TL;DR:  I'm a shy guy who   │                  │
│ Think we could have         │ tapped into a friend and    │                  │
│ something if we tried.      │ feel like we share the      │                  │
│ Don't know how to go about  │ common interests. I want to │                  │
│ pursuing a friendship       │ pursue a friendship then    │                  │
│ because she wont talk to me │ more, but my friend won't   │                  │
│ much. Is she ignoring me or │ talk to me.                 │                  │
│ just a busy person?         │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.6641, 0.334]  │
│ TITLE: Me [19 M] and her    │ TITLE: Me [19 M] and her    │                  │
│ [17 F] starting to get      │ [17 F] starting to get      │                  │
│ together. I asked her out,  │ together. I asked her out,  │                  │
│ and when the time came      │ and when the time came      │                  │
│ around she forgot we had    │ around she forgot we had    │                  │
│ plans. Not sure how to      │ plans. Not sure how to      │                  │
│ continue                    │ continue                    │                  │
│ POST: Me and this girl have │ POST: Me and this girl have │                  │
│ been chatting for awhile,   │ been chatting for awhile,   │                  │
│ and we recently made plans  │ and we recently made plans  │                  │
│ to go out for dinner.       │ to go out for dinner.       │                  │
│                             │                             │                  │
│ This morning when I asked   │ This morning when I asked   │                  │
│ her where I should pick her │ her where I should pick her │                  │
│ up she was confused. The    │ up she was confused. The    │                  │
│ conversation went like this │ conversation went like this │                  │
│                             │                             │                  │
│ me: So where should I pick  │ me: So where should I pick  │                  │
│ you up tonight              │ you up tonight              │                  │
│                             │                             │                  │
│ her:?                       │ her:?                       │                  │
│                             │                             │                  │
│ me: For dinner?             │ me: For dinner?             │                  │
│                             │                             │                  │
│ her: Sorry, did we make     │ her: Sorry, did we make     │                  │
│ plans?                      │ plans?                      │                  │
│                             │                             │                  │
│ me: Yeah                    │ me: Yeah                    │                  │
│                             │                             │                  │
│ her: Oh, I forgot :(        │ her: Oh, I forgot :(        │                  │
│                             │                             │                  │
│ I wound up never replying   │ I wound up never replying   │                  │
│ because well, what could I  │ because well, what could I  │                  │
│ have said really. It's been │ have said really. It's been │                  │
│ about 12 hours and I've     │ about 12 hours and I've     │                  │
│ thought about just texting  │ thought about just texting  │                  │
│ her to ask if she's         │ her to ask if she's         │                  │
│ actually interested because │ actually interested because │                  │
│ our conversations don't     │ our conversations don't     │                  │
│ seem to go on for very      │ seem to go on for very      │                  │
│ long, but I enjoy talking   │ long, but I enjoy talking   │                  │
│ to her.                     │ to her.                     │                  │
│                             │                             │                  │
│ And the times that we've    │ And the times that we've    │                  │
│ been together (at our       │ been together (at our       │                  │
│ mutual friends house) we've │ mutual friends house) we've │                  │
│ cuddled constantly. And she │ cuddled constantly. And she │                  │
│ seemed interested at the    │ seemed interested at the    │                  │
│ time.                       │ time.                       │                  │
│                             │                             │                  │
│ I just don't know how to    │ I just don't know how to    │                  │
│ proceed from here, she      │ proceed from here, she      │                  │
│ seems like a really cool    │ seems like a really cool    │                  │
│ person, and it'd be awesome │ person, and it'd be awesome │                  │
│ to go out with her because  │ to go out with her because  │                  │
│ she doesn't seem turned off │ she doesn't seem turned off │                  │
│ by my nerdy lifestyle. But  │ by my nerdy lifestyle. But  │                  │
│ at the same time it felt    │ at the same time it felt    │                  │
│ pretty shitty knowing she   │ pretty shitty knowing she   │                  │
│ just forgot about our       │ just forgot about our       │                  │
│ plans.                      │ plans.                      │                  │
│ TL;DR:  Asked girl I like   │ TL;DR:  Basically asking    │                  │
│ out for dinner today, she   │ her out, she forgot our     │                  │
│ forgot. Not sure how to     │ plans, and I don't know the │                  │
│ continue the convo/get      │ best way to proceed.        │                  │
│ together.                   │                             │                  │
├─────────────────────────────┼─────────────────────────────┼──────────────────┤
│ SUBREDDIT: r/relationships  │ SUBREDDIT: r/relationships  │ [0.9414, 0.0593] │
│ TITLE: I [F20] have found   │ TITLE: I [F20] have found   │                  │
│ out a guy [M21] I went out  │ out a guy [M21] I went out  │                  │
│ with a few times and was    │ with a few times and was    │                  │
│ going to get involved with  │ going to get involved with  │                  │
│ used to watch child porn    │ used to watch child porn    │                  │
│ and bestiality.             │ and bestiality.             │                  │
│ POST: We've only known each │ POST: We've only known each │                  │
│ other that well a month but │ other that well a month but │                  │
│ we got along very well, he  │ we got along very well, he  │                  │
│ was very chatty. The topic  │ was very chatty. The topic  │                  │
│ came up of what was the     │ came up of what was the     │                  │
│ worst things we've done, he │ worst things we've done, he │                  │
│ said he used to watch child │ said he used to watch child │                  │
│ porn a few years back and   │ porn a few years back and   │                  │
│ that he is still into       │ that he is still into       │                  │
│ bestiality. But he shows    │ bestiality. But he shows    │                  │
│ little remorse over it      │ little remorse over it      │                  │
│ other than that it's an     │ other than that it's an     │                  │
│ illegal thing. So I ended   │ illegal thing. So I ended   │                  │
│ the relationship, but in    │ the relationship, but in    │                  │
│ the interim I had slept     │ the interim I had slept     │                  │
│ with him (before knowing).  │ with him (before knowing).  │                  │
│ I didn't want to be         │ I didn't want to be         │                  │
│ judgmental, I wanted to     │ judgmental, I wanted to     │                  │
│ think he could be redeemed  │ think he could be redeemed  │                  │
│ and that so long as he      │ and that so long as he      │                  │
│ wasn't directly harming     │ wasn't directly harming     │                  │
│ anyone that it'd be okay,   │ anyone that it'd be okay,   │                  │
│ but it's not. I feel so     │ but it's not. I feel so     │                  │
│ much disgust now.           │ much disgust now.           │                  │
│                             │                             │                  │
│ I seem to keep finding guys │ I seem to keep finding guys │                  │
│ like this, who tell me how  │ like this, who tell me how  │                  │
│ they want to murder people  │ they want to murder people  │                  │
│ or hurt people and all of   │ or hurt people and all of   │                  │
│ this dark, dark stuff. I    │ this dark, dark stuff. I    │                  │
│ don't understand, most      │ don't understand, most      │                  │
│ people tell me that I come  │ people tell me that I come  │                  │
│ off witty, funny and        │ off witty, funny and        │                  │
│ light-hearted. The only     │ light-hearted. The only     │                  │
│ thing I can think of is     │ thing I can think of is     │                  │
│ that people tend to find me │ that people tend to find me │                  │
│ understanding and easy to   │ understanding and easy to   │                  │
│ get into an intense         │ get into an intense         │                  │
│ conversation with.          │ conversation with.          │                  │
│ TL;DR:  Guy I was going to  │ TL;DR:  I keep finding dark │                  │
│ get involved with told me   │ guys, and I want someone    │                  │
│ he used to watch child porn │ light. Is it normal for     │                  │
│ and bestiality and I don't  │ certain people to be secret │                  │
│ know how to react.          │ keepers?                    │                  │
└─────────────────────────────┴─────────────────────────────┴──────────────────┘
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
  0%|          | 0/39 [00:00<?, ?it/s]  5%|▌         | 2/39 [00:06<01:59,  3.24s/it]  8%|▊         | 3/39 [00:12<02:44,  4.57s/it] 10%|█         | 4/39 [00:18<02:53,  4.96s/it] 13%|█▎        | 5/39 [00:24<03:05,  5.46s/it] 15%|█▌        | 6/39 [00:31<03:09,  5.75s/it] 18%|█▊        | 7/39 [00:37<03:08,  5.90s/it] 21%|██        | 8/39 [00:43<03:07,  6.05s/it] 23%|██▎       | 9/39 [00:50<03:05,  6.19s/it] 26%|██▌       | 10/39 [00:56<03:00,  6.23s/it] 28%|██▊       | 11/39 [01:03<02:57,  6.32s/it] 31%|███       | 12/39 [01:09<02:50,  6.32s/it] 33%|███▎      | 13/39 [01:15<02:45,  6.37s/it] 36%|███▌      | 14/39 [01:22<02:39,  6.36s/it] 38%|███▊      | 15/39 [01:28<02:30,  6.26s/it] 41%|████      | 16/39 [01:34<02:24,  6.30s/it] 44%|████▎     | 17/39 [01:40<02:14,  6.11s/it] 46%|████▌     | 18/39 [01:46<02:09,  6.17s/it] 49%|████▊     | 19/39 [01:53<02:04,  6.25s/it] 51%|█████▏    | 20/39 [01:59<01:59,  6.30s/it] 54%|█████▍    | 21/39 [02:06<01:54,  6.34s/it] 56%|█████▋    | 22/39 [02:12<01:46,  6.28s/it] 59%|█████▉    | 23/39 [02:18<01:42,  6.38s/it] 62%|██████▏   | 24/39 [02:25<01:35,  6.38s/it] 64%|██████▍   | 25/39 [02:31<01:29,  6.42s/it] 67%|██████▋   | 26/39 [02:38<01:23,  6.44s/it] 69%|██████▉   | 27/39 [02:44<01:17,  6.46s/it] 72%|███████▏  | 28/39 [02:51<01:11,  6.47s/it] 74%|███████▍  | 29/39 [02:57<01:04,  6.47s/it] 77%|███████▋  | 30/39 [03:03<00:57,  6.43s/it] 79%|███████▉  | 31/39 [03:09<00:50,  6.30s/it] 82%|████████▏ | 32/39 [03:16<00:44,  6.36s/it] 85%|████████▍ | 33/39 [03:22<00:38,  6.37s/it] 87%|████████▋ | 34/39 [03:29<00:32,  6.43s/it] 90%|████████▉ | 35/39 [03:35<00:25,  6.46s/it] 92%|█████████▏| 36/39 [03:42<00:19,  6.46s/it] 95%|█████████▍| 37/39 [03:48<00:12,  6.45s/it] 97%|█████████▋| 38/39 [03:54<00:06,  6.23s/it]100%|██████████| 39/39 [03:58<00:00,  5.65s/it]/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/trl/trainer/utils.py:750: UserWarning: There are 3 out of 1238 instances where the predictions for both options are equal. As a consequence the accuracy can be misleading.
  warnings.warn(
100%|██████████| 39/39 [03:58<00:00,  6.12s/it]
***** eval metrics *****
  epoch                   =        1.0
  eval_accuracy           =     0.6591
  eval_loss               =     0.6316
  eval_runtime            = 0:04:05.10
  eval_samples_per_second =      5.051
  eval_steps_per_second   =      0.159
wandb: - 1.819 MB of 1.819 MB uploadedwandb: \ 1.819 MB of 1.819 MB uploadedwandb: | 1.819 MB of 1.819 MB uploadedwandb: / 1.819 MB of 1.819 MB uploadedwandb: - 1.819 MB of 1.819 MB uploadedwandb: \ 1.849 MB of 2.056 MB uploaded (0.003 MB deduped)wandb: | 2.056 MB of 2.056 MB uploaded (0.003 MB deduped)wandb: 
wandb: Run history:
wandb:           eval/accuracy ▁▆██▆▃▆▁▅
wandb:               eval/loss █▇▁▆▃▅▄▁▅
wandb:            eval/runtime ▅█▅▁▃▆▆▄▁
wandb: eval/samples_per_second ▄▁▄█▆▃▃▅█
wandb:   eval/steps_per_second ▅▁▅█▅▁▅▅█
wandb:             train/epoch ▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇████
wandb:       train/global_step ▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇█████
wandb:         train/grad_norm ▅▃▅▃▃▅▇▃▇▅▄█▆▄▂▅▄▅▅▄▅▂▄▄▄▃▄▃▂▃█▅▃▅▄▅▂▆▃▁
wandb:     train/learning_rate ███▇▇▇▇▇▇▆▆▆▆▆▆▅▅▅▅▅▄▄▄▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▁▁
wandb:              train/loss ▁▂▅▄▂▁▆▃▄▃▃█▃▃▃▃▄▆▆▄▃▁▃▂▂▁▃▅▄▄█▄▁▃▄▂▃▆▅▃
wandb: 
wandb: Run summary:
wandb:            eval/accuracy 0.65913
wandb:                eval/loss 0.63158
wandb:             eval/runtime 245.1026
wandb:  eval/samples_per_second 5.051
wandb:    eval/steps_per_second 0.159
wandb:               total_flos 0.0
wandb:              train/epoch 1.0
wandb:        train/global_step 42
wandb:          train/grad_norm 0.77072
wandb:      train/learning_rate 0.0
wandb:               train/loss 0.4424
wandb:               train_loss 0.45261
wandb:            train_runtime 5519.5997
wandb: train_samples_per_second 0.973
wandb:   train_steps_per_second 0.008
wandb: 
wandb: 🚀 View run ./exp/gpt-j-6b-Reward/lr-5e-5-3epochs-lorar32-user-2/pslora at: https://wandb.ai/panda12345pa/federated%20LoRA/runs/90412hbf
wandb: ⭐️ View project at: https://wandb.ai/panda12345pa/federated%20LoRA
wandb: Synced 6 W&B file(s), 9 media file(s), 11 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240926_051400-90412hbf/logs
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/sentry_sdk/session.py:111: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow()
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmprrspocmk'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmps9jkjdt6'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmp7cs9x9_z'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmp3ddjvkm2'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmpr7b3x8kr'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmpisqb8d90'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmpoahxr3jc'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmp_sos_xmk'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmpp_vby2b5'>
  _warnings.warn(warn_message, ResourceWarning)
/home/donghao_dev/anaconda3/envs/RLHF/lib/python3.12/tempfile.py:936: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/tmpz67cwo_a'>
  _warnings.warn(warn_message, ResourceWarning)
